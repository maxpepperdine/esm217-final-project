---
title: "Data upload & exploration"
author: "Maxwell Pepperdine"
format: html
editor: visual
---

```{r}
rm(list = ls())
```

## Overview

This script loads and explores the necessary data for the project.

## Data description

`PM2.5`:
- Sourced from the [Environmental Change & Human Outcomes Lab (ECHO)](https://www.stanfordecholab.com/wildfire_smoke)
- Contains daily 10km wildfire smoke PM2.5 data between 2006-2023, also providing county, censust tract, and zip code level estimates
- Citation:
    - 

- ...

## Load packages

```{r}
library(lubridate)
library(sf)
library(dplyr)
library(tidyr)
library(tidyverse)
library(here)
```

## Load data

#### PM2.5 data

###### Script provided by the `daily-10km-smokePM` repository linked [here](https://github.com/echolab-stanford/daily-10km-smokePM)

```{r}
# Load smokePM predictions on smoke days
preds = readRDS(here("data/PM2_5/10km_grid/smokePM2pt5_predictions_daily_10km_20060101-20231231.rds"))

# Load 10 km grid
grid_10km = read_sf(here("data/PM2_5/10km_grid/10km_grid_wgs84/10km_grid_wgs84.shp"))

# Load full set of dates
dates = seq.Date(ymd("20060101"), ymd("20201231"), by = "day")

# Get full combination of grid cell-days
# Warning: this may require a large amount of memory
out = expand.grid(grid_id_10km = grid_10km$ID, date = dates)

# Match smokePM predictions on smoke days to grid cell-days
out = left_join(out, preds, by = c("grid_id_10km", "date"))

# Predict 0 for remaining grid cell-days, which are non-smoke days
out = mutate(out, smokePM_pred = replace_na(smokePM_pred, 0))
```

#### Asthma data 

```{r}
# by county (2011-2023)
# this data from the CDPHE includes asthma hospitilization & ED visits 
# it has yearly and monthly asthma rates
asthma_county_yearly <- read_csv(here("data/asthma/yearly_ED_AA_asthma_2011_2023.csv"))
asthma_county_monthly <- read_csv(here("data/asthma/monthly_ED_AA_asthma_2011_2023.csv"))
```






















